function [taps, nse_sigma_mul, nse_BW_Hz, offset_dB_to_dBFS_per_Hz] = LPF_Remez(ripple_dB, suppr_dB, f_pass_Hz, f_stop_Hz, SAMPLE_RATE_Hz)
% Синтез КИХ-фильтра нижних частот методом Ремеза
% Физика: создает антиалиазингный фильтр для ограничения полосы сигнала
% Программирование: расчет коэффициентов фильтра с заданными параметрами

   f = [f_pass_Hz  f_stop_Hz];
   a = [1  0];  % Амплитудная характеристика: 1 в полосе пропускания, 0 в полосе задерживания

   % Перевод параметров из дБ в линейные величины
   rp = ripple_dB;
   p = (10^(rp/20)-1) / (10^(rp/20)+1);  % Неравномерность в полосе пропускания
   rs = suppr_dB;
   z = 10^(-rs/20);  % Подавление в полосе задерживания

   dev = [p z];  % Вектор отклонений

   % Расчет порядка и коэффициентов фильтра
   [n, fo, ao, w] = remezord(f, a, dev, SAMPLE_RATE_Hz);
   taps = remez(n, fo, ao, w).';  % Коэффициенты фильтра

   % Расчет эквивалентной шумовой полосы
   nse_sigma_mul = 1 / sqrt( taps' * taps );  % Нормировочный коэффициент для шума
   nse_BW_Hz = SAMPLE_RATE_Hz / nse_sigma_mul^2;  % Эквивалентная шумовая полоса
   offset_dB_to_dBFS_per_Hz = -10 * log10(nse_BW_Hz);  % Смещение для пересчета в дБ/Гц
end % function
