┌─────────────────────────────────────────────────────────────────┐
│              ОБРАБОТКА ПРИНЯТОГО СИГНАЛА 12 кГц                 │
│                index_rx_processing_12.m                         │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  ИНИЦИАЛИЗАЦИЯ И ЗАГРУЗКА ДАННЫХ                                │
│  - Загрузка эталонного сигнала:                                 │
│    mas_CSS_etalon_IQ = read_cfloat32('etalon_12kHz')            │
│  - Загрузка принятых данных (один из вариантов):                │
│    • Малышево, Хохольский, Тамбов, цифровой эксперимент         │
│  - Расчет масштабных осей для графиков                          │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  ПРЕДВАРИТЕЛЬНАЯ ОБРАБОТКА                                      │
│  mas_Rx_IQ = my_freq_shift(...) - частотная коррекция           │
│  │                                                              │
│  ▼                                                              │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │          ФУНКЦИЯ my_freq_shift                          │    │
│  │  Компенсация допплеровского смещения:                   │    │
│  │  - Умножение на exp(1i*2π*Δf*t)                         │    │
│  │  - freq_shift_Hz = 10.322 (подобран эмпирически)        │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  ФИЛЬТРАЦИЯ СИГНАЛА                                             │
│  [taps_FIR_Rx, ...] = LPF_Remez(...) - синтез фильтра           │
│  │                                                              │
│  ▼                                                              │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │           ФУНКЦИЯ LPF_Remez                             │    │
│  │  Синтез КИХ-фильтра методом Ремеза:                     │    │
│  │  - f_pass_Hz = 6000, f_stop_Hz = 8000                   │    │
│  │  - ripple_dB = 0.001, suppr_dB = 120                    │    │
│  │  - Подавление внеполосных помех                         │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  mas_Rx_IQ_fir = conv(..., 'same') - применение фильтра         │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  СИНХРОНИЗАЦИЯ                                                  │
│  [sync_point, ...] = search_sync_point(...)                     │
│  │                                                              │
│  ▼                                                              │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │        ФУНКЦИЯ search_sync_point                        │    │
│  │  Поиск начала сигнала по максимуму корреляции:          │    │
│  │  - Циклическая корреляция с эталоном                    │    │
│  │  - Обрезка сигнала до точки синхронизации               │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  ПОСТРОЕНИЕ ДИАГРАММЫ "ЗАДЕРЖКА-ВРЕМЯ"                          │
│  for n = 1:fft_len_slow                                         │
│    mas_resp = сегмент_сигнала .* conj(эталон)                   │
│    matr_Delay_Time(n,:) = fftshift(ifft(mas_resp .* окно))      │
│  end                                                            │
│  - Обратное БПФ дает импульсную характеристику канала           │
│  - Оконная функция уменьшает боковые лепестки                   │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  РАСЧЕТ POWER-DELAY PROFILE (PDP)                               │
│  mas_PDP = mean(abs(matr_Delay_Time).^2).'                      │
│  - Усреднение мощности по времени                               │
│  - Характеристика многолучевого распространения                 │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  ПОСТРОЕНИЕ ДИАГРАММЫ "ЗАДЕРЖКА-ДОППЛЕР"                        │
│  for i_tau = 1:fft_len                                          │
│    matr_Delay_Doppler(:,i_tau) = fftshift(fft(...))             │
│  end                                                            │
│  - БПФ по "медленному" времени для анализа Допплера             │
│  - Выявление допплеровских смещений лучей                       │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  ОЦЕНКА ОТНОШЕНИЯ СИГНАЛ-ШУМ (ОСШ)                              │
│  - P_all = общая мощность                                       │
│  - P_signal = мощность сигнала (за вычетом шума)                │
│  - SNR_estim_dB = pow2db(P_signal/(P_all-P_signal))             │
│  - Автоматическая оценка по шумовой полке                       │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  ВИЗУАЛИЗАЦИЯ РЕЗУЛЬТАТОВ                                       │
│  - Figure 1: Диаграмма "Задержка-Время" (imagesc)               │
│  - Figure 2: Power-Delay Profile (plot)                         │
│  - Figure 3: Диаграмма "Задержка-Допплер" (imagesc)             │
│  - Динамические диапазоны настроены для лучшего отображения     │
└─────────────────────────────────────────────────────────────────┘