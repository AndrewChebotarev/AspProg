Функции из папки src, используемые в index_rx_processing_12.m:
1. Основные функции обработки сигналов:
matlab
% Загрузка эталонного сигнала
mas_CSS_etalon_IQ = read_cfloat32('test_iq_etalon/etalon_12kHz');
Использует: read_cfloat32() - чтение комплексных данных из бинарного файла

matlab
% Частотный сдвиг для компенсации допплера
mas_Rx_IQ = my_freq_shift(mas_Rx_IQ, 0, freq_shift_Hz, SAMPLE_RATE_Hz);
Использует: my_freq_shift() - частотный сдвиг сигнала

matlab
% Синтез КИХ-фильтра
[taps_FIR_Rx, nse_sigma_mul] = LPF_Remez(ripple_dB, suppr_dB, f_pass_Hz, f_stop_Hz, SAMPLE_RATE_Hz);
Использует: LPF_Remez() - синтез КИХ-фильтра методом Ремеза

matlab
% Визуализация сигнала
my_oscillogram(mas_Rx_IQ, SAMPLE_RATE_Hz);
my_spectr(mas_Rx_IQ, SAMPLE_RATE_Hz);
my_spectrogram_db(mas_Rx_IQ(1:180*SAMPLE_RATE_Hz), 1024, SAMPLE_RATE_Hz);
Использует:

my_oscillogram() - построение осциллограммы

my_spectr() - построение спектра

my_spectrogram_db() - построение спектрограммы

matlab
% Синхронизация по корреляции
[sync_point, mas_resp_sync] = search_sync_point(mas_Rx_IQ_fir, mas_CSS_etalon_IQ);
Использует: search_sync_point() - поиск точки синхронизации

2. Дополнительные функции (закомментированные):
matlab
% save_to_float32(taps_FIR_Rx, 'data_for_cpp_maket/taps_FIR_Rx_24k_28k_120_SR96k');
% float32_to_txt(taps_FIR_Rx, 'data_for_cpp_maket/taps_FIR_Rx_6k_8k_120_SR48k');
Использует (если раскомментировать):

save_to_float32() - сохранение вещественных данных

float32_to_txt() - экспорт в текстовый формат

3. Функции MATLAB, которые также используются:
load() - загрузка .mat файлов

conv() - свертка для фильтрации

fft(), ifft(), fftshift() - преобразования Фурье

window() - оконные функции

complex() - создание комплексных чисел

floor(), length(), size() - базовые операции

plot(), imagesc(), figure() - визуализация

mag2db(), pow2db() - преобразования в дБ


┌─────────────────────────────────────────────────────────────────┐
│                ФОРМИРОВАНИЕ ЛЧМ-СИГНАЛА 12 кГц                  │
│                index_make_wb_sounding_signal_12.m               │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  ИНИЦИАЛИЗАЦИЯ                                                  │
│  - clc, clear - очистка среды                                   │
│  - addpath('src') - добавление путей к функциям                 │
│  - SAMPLE_RATE_Hz = 48000 - установка частоты дискретизации     │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  РАСЧЕТ ПАРАМЕТРОВ                                              │
│  - fft_loglen = 11 → fft_len = 2048                             │
│  - chirp_bandwidth_Hz = 12000                                   │
│  - reverse_chirp_divider = 32                                   │
│  - att_dB = 0.25 → att_mul = 10^(-0.25/20)                      │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  ВЫЗОВ ФУНКЦИИ ГЕНЕРАЦИИ ЛЧМ                                    │
│  mas_CSS_12k_IQ = make_css_iq(...)                              │
│  │                                                              │
│  ▼                                                              │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │         ФУНКЦИЯ make_css_iq (внешняя)                   │    │
│  │  Создает линейно-частотно модулированный сигнал:        │    │
│  │  - Прямой chirp: от -f0 до +f0                          │    │
│  │  - Обратный chirp: короткий сегмент обратного хода      │    │
│  │  - Умножение на att_mul для предотвращения перегрузки   │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  СОХРАНЕНИЕ ЭТАЛОННОГО СИГНАЛА                                  │
│  save_to_cfloat32(mas_CSS_12k_IQ, ...)                          │
│  │                                                              │
│  ▼                                                              │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │           ФУНКЦИЯ save_to_cfloat32                      │    │
│  │  Сохраняет в бинарный формат:                           │    │
│  │  - test_iq_etalon/etalon_12kHz.cfloat32                 │    │
│  │  - Чередование real/imag компонент float32              │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  СОЗДАНИЕ ПЕРЕДАВАЕМОГО СИГНАЛА                                 │
│  - N_repeats = 10 - 10 повторений эталона                       │
│  - mas_Tx_12k_IQ = конкатенация периодов                        │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  ВИЗУАЛИЗАЦИЯ (опционально)                                     │
│  my_oscillogram() - осциллограмма                               │
│  my_spectr() - спектр                                           │
│  my_spectrogram_db() - спектрограмма                            │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│  СОХРАНЕНИЕ ПЕРЕДАВАЕМОГО СИГНАЛА                               │
│  save_to_cfloat32(mas_Tx_12k_IQ, ...)                           │
│  │                                                              │
│  ▼                                                              │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │           ФУНКЦИЯ save_to_cfloat32                      │    │
│  │  Сохраняет в: test_iq_tx/sounding_12kHz.cfloat32        │    │
│  │  Для передачи через HackRF                              │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘